!function(){"use strict";var e,t={75:function(e,t,n){var o=window.wp.blocks,r=window.wp.i18n,a=window.wp.element,c=window.wp.apiFetch,i=n.n(c),l=window.wp.blockEditor,s=window.wp.components,u=window.wp.data;function p(e,t,n,o,r){const a={content:o};t&&(a.token=t,n(!1)),r(!0),e({requestedPrompt:!0}),i()({path:"/coauthor/prompt",method:"POST",data:a}).then((t=>{r(!1);const n=t.prompts[0].text.split(" ");for(let t=0;t<n.length;t++){const o=n.slice(0,t).join(" ");setTimeout((()=>e({content:o})),50*t)}})).catch((t=>{"openai_token_missing"===t.code&&(n(!0),r(!1),e({requestedPrompt:!1}))}))}(0,o.registerBlockType)("coauthor/paragraph",{apiVersion:2,title:(0,r.__)("Coauthor Paragraph","coauthor"),description:(0,r.__)("Automatically generate new paragraphs using your existing content, GPT-3 and robots.","coauthor"),category:"common",icon:"welcome-write-blog",supports:{html:!1},attributes:{content:{type:"string",source:"text"},requestedPrompt:{type:"boolean",default:!1}},transforms:{to:[{type:"block",blocks:["core/paragraph"],transform:e=>{let{content:t}=e;return(0,o.createBlock)("core/paragraph",{content:t})}}]},edit:function(e){let{attributes:t,setAttributes:n}=e;const[o,r]=(0,a.useState)(!1),[c,i]=(0,a.useState)(!1),[m,d]=(0,a.useState)(""),g=(0,u.useSelect)((e=>function(e){const t=e.getBlockInsertionPoint().index-1;return e.getBlocks().slice(0,t).filter((function(e){return e&&e.attributes&&e.attributes.content})).map((function(e){return e.attributes.content.replaceAll("<br>","\n\n")})).join("\n\n")}(e("core/block-editor"))),[]);return(0,a.useEffect)((()=>{t.content||t.requestedPrompt||p(n,!1,r,g,i)}),[]),(0,a.createElement)("div",(0,l.useBlockProps)(),o&&(0,a.createElement)("div",null,(0,a.createElement)(s.TextControl,{label:"Please provide the OpenAI token to continue:",value:m,onChange:e=>d(e)}),(0,a.createElement)(s.Button,{isPrimary:!0,onClick:()=>{p(n,m,r,g,i)}},"Submit")),t.content&&!c&&(0,a.createElement)("div",null,(0,a.createElement)("div",{className:"content"},(0,a.createElement)(a.RawHTML,null,t.content.trim().replaceAll("\n","<br/>")))),c&&(0,a.createElement)("div",{style:{padding:"10px",textAlign:"center"}},(0,a.createElement)(s.Spinner,{style:{height:"calc(4px * 20)",width:"calc(4px * 20)"}})))},saveParagraph:function(e){let{attributes:t}=e;const n=l.useBlockProps.save();return(0,a.createElement)("div",n,t.content)}}),(0,o.registerBlockType)("coauthor/image",{apiVersion:2,title:(0,r.__)("Coauthor Image","coauthor"),description:(0,r.__)("Automatically generate an illustration for your post","coauthor"),category:"common",icon:"welcome-write-blog",supports:{html:!1},attributes:{content:{type:"string",source:"text"},requestedPrompt:{type:"string",default:!1}},edit:function(e){let{attributes:t,setAttributes:n,clientId:r}=e;const[c,p]=(0,a.useState)(!1),[m,d]=(0,a.useState)([]),[g,h]=(0,a.useState)(""),{replaceBlock:f}=(0,u.useDispatch)(l.store),{mediaUpload:b}=(0,u.useSelect)((e=>{const{getSettings:t}=e(l.store);return{mediaUpload:t().mediaUpload}}),[]);return(0,a.createElement)("div",(0,l.useBlockProps)(),(0,a.createElement)(s.Placeholder,{label:"Coauthor Image"},!t.requestedPrompt&&(0,a.createElement)("div",null,(0,a.createElement)(s.TextControl,{label:"What would you like to see?",onChange:h}),(0,a.createElement)(s.Button,{isPrimary:!0,onClick:()=>function(e,t,n,o){n(!0),t({requestedPrompt:e}),i()({path:"/coauthor/image",method:"POST",data:{prompt:e}}).then((e=>{n(!1);const t=e.data.map((e=>"data:image/png;base64,"+e.b64_json));o(t)})).catch((e=>{"openai_token_missing"===e.code&&(setPromptedForToken(!0),n(!1),t({requestedPrompt:""}))}))}(g,n,p,d)},"Submit")),!c&&m.length>0&&(0,a.createElement)("div",null,(0,a.createElement)("div",{style:{textAlign:"center",margin:"12px",fontStyle:"italic"}},t.requestedPrompt),(0,a.createElement)("div",{style:{fontSize:"20px",lineHeight:"38px"}},"Please choose your image"),(0,a.createElement)("div",{style:{flexDirection:"row",justifyContent:"space-between",textAlign:"center"}},m.map((e=>(0,a.createElement)("img",{style:{width:"128px",padding:"8px"},src:e,key:e,onClick:async()=>{const n=await fetch(e),a=await n.blob(),c=new File([a],"coauthor_image.png",{type:"image/png"});b({filesList:[c],onFileChange:e=>{let[n]=e;f(r,(0,o.createBlock)("core/image",{url:n.url,caption:t.requestedPrompt,alt:t.requestedPrompt}))},allowedTypes:["image"],onError:e=>{console.error(e)}})}}))))),t.content&&!c&&(0,a.createElement)("div",null,(0,a.createElement)("div",{className:"content"},t.content)),c&&(0,a.createElement)("div",{style:{padding:"10px",textAlign:"center"}},(0,a.createElement)(s.Spinner,{style:{height:"calc(4px * 20)",width:"calc(4px * 20)"}}))))},save:function(e){let{attributes:t}=e;const n=l.useBlockProps.save();return(0,a.createElement)("div",n,t.content)}})}},n={};function o(e){var r=n[e];if(void 0!==r)return r.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,o),a.exports}o.m=t,e=[],o.O=function(t,n,r,a){if(!n){var c=1/0;for(u=0;u<e.length;u++){n=e[u][0],r=e[u][1],a=e[u][2];for(var i=!0,l=0;l<n.length;l++)(!1&a||c>=a)&&Object.keys(o.O).every((function(e){return o.O[e](n[l])}))?n.splice(l--,1):(i=!1,a<c&&(c=a));if(i){e.splice(u--,1);var s=r();void 0!==s&&(t=s)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[n,r,a]},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,{a:t}),t},o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={826:0,431:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,a,c=n[0],i=n[1],l=n[2],s=0;if(c.some((function(t){return 0!==e[t]}))){for(r in i)o.o(i,r)&&(o.m[r]=i[r]);if(l)var u=l(o)}for(t&&t(n);s<c.length;s++)a=c[s],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(u)},n=self.webpackChunkcoauthor=self.webpackChunkcoauthor||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var r=o.O(void 0,[431],(function(){return o(75)}));r=o.O(r)}();