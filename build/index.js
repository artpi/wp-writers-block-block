!function(){"use strict";var e,t={75:function(e,t,n){var r=window.wp.blocks,o=window.wp.i18n,a=window.wp.element,l=window.wp.apiFetch,c=n.n(l),s=window.wp.blockEditor,u=window.wp.components,p=window.wp.data;function m(e,t,n,r,o){if(n.length<120)return void o(!0);o(!1);const a={content:n=n.slice(-240)};r(!0),e({requestedPrompt:!0}),c()({path:"/wp/v2/openai/completions",method:"POST",data:a}).then((t=>{r(!1);const n=t.prompts[0].text,o=n.split(" ");for(let t=0;t<o.length;t++){const n=o.slice(0,t).join(" ");setTimeout((()=>e({content:n})),50*t)}setTimeout((()=>e({content:n})),50*(i+1))})).catch((n=>{"token_missing"===n.code&&(t(!0),r(!1),e({requestedPrompt:!1}))}))}(0,r.registerBlockType)("coauthor/paragraph",{apiVersion:2,title:(0,o.__)("Coauthor Paragraph","coauthor"),description:(0,o.__)("Automatically generate new paragraphs using your existing content, GPT-3 and robots.","coauthor"),category:"common",icon:"welcome-write-blog",supports:{html:!1},attributes:{content:{type:"string",source:"text"},requestedPrompt:{type:"boolean",default:!1}},transforms:{to:[{type:"block",blocks:["core/paragraph"],transform:e=>{let{content:t}=e;return(0,r.createBlock)("core/paragraph",{content:t})}}]},edit:function(e){let{attributes:t,setAttributes:n}=e;const[r,o]=(0,a.useState)(!1),[i,l]=(0,a.useState)(!1),[c,d]=(0,a.useState)(!1),h=(0,p.useSelect)((e=>function(e){const t=e.getBlockInsertionPoint().index-1;return e.getBlocks().slice(0,t).filter((function(e){return e&&e.attributes&&e.attributes.content})).map((function(e){return e.attributes.content.replaceAll("<br>","\n\n")})).join("\n\n")}(e("core/block-editor"))),[]);return(0,a.useEffect)((()=>{t.content||t.requestedPrompt||m(n,o,h,l,d)}),[]),(0,a.createElement)("div",(0,s.useBlockProps)(),c&&(0,a.createElement)(u.Placeholder,{label:"Coauthor Paragraph",instructions:"Please write a little bit more. Coauthor needs more text to make the gears spin."},(0,a.createElement)(u.Button,{isPrimary:!0,onClick:()=>{m(n,o,h,l,d)}},"Retry")),r&&(0,a.createElement)(u.Placeholder,{label:"Coauthor Paragraph",instructions:"Please visit settings and input valid OpenAI token"},(0,a.createElement)(u.Button,{isPrimary:!0,href:"options-general.php?page=coauthor",target:"_blank"},"Visit Coauthor Settings")),t.content&&!i&&(0,a.createElement)("div",null,(0,a.createElement)("div",{className:"content"},(0,a.createElement)(a.RawHTML,null,t.content.trim().replaceAll("\n","<br/>")))),i&&(0,a.createElement)("div",{style:{padding:"10px",textAlign:"center"}},(0,a.createElement)(u.Spinner,{style:{height:"calc(4px * 20)",width:"calc(4px * 20)"}})))},saveParagraph:function(e){let{attributes:t}=e;const n=s.useBlockProps.save();return(0,a.createElement)("div",n,t.content)}}),(0,r.registerBlockType)("coauthor/image",{apiVersion:2,title:(0,o.__)("Coauthor Image","coauthor"),description:(0,o.__)("Automatically generate an illustration for your post","coauthor"),category:"common",icon:"welcome-write-blog",supports:{html:!1},attributes:{content:{type:"string",source:"text"},requestedPrompt:{type:"string",default:!1}},edit:function(e){let{attributes:t,setAttributes:n,clientId:o}=e;const[i,l]=(0,a.useState)(!1),[m,d]=(0,a.useState)([]),[h,g]=(0,a.useState)(""),{replaceBlock:f}=(0,p.useDispatch)(s.store),[b,v]=(0,a.useState)(""),{mediaUpload:w}=(0,p.useSelect)((e=>{const{getSettings:t}=e(s.store);return{mediaUpload:t().mediaUpload}}),[]),E=()=>function(e,t,n,r,o){n(!0),t({requestedPrompt:e}),c()({path:"/wp/v2/openai/images/generations",method:"POST",data:{prompt:e}}).then((e=>{if(n(!1),e.error&&e.error.message)return void o(e.error.message);const t=e.data.map((e=>"data:image/png;base64,"+e.b64_json));r(t)})).catch((e=>{"token_missing"===e.code&&(o("Please visit settings and input valid OpenAI token"),n(!1))}))}(h,n,l,d,v);return(0,a.createElement)("div",(0,s.useBlockProps)(),!i&&b&&(0,a.createElement)(u.Placeholder,{label:"Coauthor Image",notices:[(0,a.createElement)("div",null,b)]},(0,a.createElement)(u.TextareaControl,{label:"What would you like to see?",value:h,onChange:g}),(0,a.createElement)(u.Flex,{direction:"row"},(0,a.createElement)(u.FlexItem,null,(0,a.createElement)(u.Button,{isPrimary:!0,onClick:()=>{v(""),E()}},"Retry")),"Please visit settings and input valid OpenAI token"===b&&(0,a.createElement)(u.FlexItem,null,(0,a.createElement)(u.Button,{href:"options-general.php?page=coauthor",target:"_blank"},"Visit Coauthor Settings")))),!b&&!t.requestedPrompt&&(0,a.createElement)(u.Placeholder,{label:"Coauthor Image"},(0,a.createElement)("div",null,(0,a.createElement)(u.TextareaControl,{label:"What would you like to see?",onChange:g}),(0,a.createElement)(u.Button,{isPrimary:!0,onClick:E},"Submit"))),!b&&!i&&m.length>0&&(0,a.createElement)(u.Placeholder,{label:"Coauthor Image"},(0,a.createElement)("div",null,(0,a.createElement)("div",{style:{textAlign:"center",margin:"12px",fontStyle:"italic"}},t.requestedPrompt),(0,a.createElement)("div",{style:{fontSize:"20px",lineHeight:"38px"}},"Please choose your image"),(0,a.createElement)(u.Flex,{direction:"row",justify:"space-between"},m.map((e=>(0,a.createElement)(u.FlexBlock,{key:e},(0,a.createElement)("img",{className:"wp-block-coauthor-image-image",src:e,onClick:async()=>{if(i)return;l(!0);const n=await fetch(e),a=await n.blob(),c=new File([a],"coauthor_image.png",{type:"image/png"});w({filesList:[c],onFileChange:e=>{let[n]=e;n.id&&f(o,(0,r.createBlock)("core/image",{url:n.url,caption:t.requestedPrompt,alt:t.requestedPrompt}))},allowedTypes:["image"],onError:e=>{console.error(e),l(!1)}})}}))))))),!b&&t.content&&!i&&(0,a.createElement)(u.Placeholder,{label:"Coauthor Image"},(0,a.createElement)("div",null,(0,a.createElement)("div",{className:"content"},t.content))),!b&&i&&(0,a.createElement)(u.Placeholder,{label:"Coauthor Image"},(0,a.createElement)("div",{style:{padding:"10px",textAlign:"center"}},(0,a.createElement)(u.Spinner,{style:{height:"calc(4px * 20)",width:"calc(4px * 20)"}}))))},save:function(e){let{attributes:t}=e;const n=s.useBlockProps.save();return(0,a.createElement)("div",n,t.content)}})}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,r),a.exports}r.m=t,e=[],r.O=function(t,n,o,a){if(!n){var i=1/0;for(u=0;u<e.length;u++){n=e[u][0],o=e[u][1],a=e[u][2];for(var l=!0,c=0;c<n.length;c++)(!1&a||i>=a)&&Object.keys(r.O).every((function(e){return r.O[e](n[c])}))?n.splice(c--,1):(l=!1,a<i&&(i=a));if(l){e.splice(u--,1);var s=o();void 0!==s&&(t=s)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[n,o,a]},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={826:0,431:0};r.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,a,i=n[0],l=n[1],c=n[2],s=0;if(i.some((function(t){return 0!==e[t]}))){for(o in l)r.o(l,o)&&(r.m[o]=l[o]);if(c)var u=c(r)}for(t&&t(n);s<i.length;s++)a=i[s],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(u)},n=self.webpackChunkcoauthor=self.webpackChunkcoauthor||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var o=r.O(void 0,[431],(function(){return r(75)}));o=r.O(o)}();